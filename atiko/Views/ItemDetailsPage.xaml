<Page
    x:Class="atiko.Views.ItemDetailsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:Microsoft.UI.Xaml.Controls"
    Background="{StaticResource BackgroundBrush}"
    Loaded="Page_Loaded">

    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <controls:XamlControlsResources />
                <ResourceDictionary Source="/Styles/AppStyles.xaml" />
                <ResourceDictionary Source="/Converters/Converters.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <Storyboard x:Key="FadeInAnimation">
                <DoubleAnimation Storyboard.TargetName="DetailsPanel" Storyboard.TargetProperty="Opacity" From="0.0" To="1.0" Duration="0:0:0.5" />
            </Storyboard>

            <Style x:Key="ItemHeaderStyle" TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlockStyle}">
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Margin" Value="0,0,0,8"/>
                <Setter Property="HorizontalAlignment" Value="Left"/>
            </Style>
            <Style x:Key="ItemContentStyle" TargetType="TextBlock" BasedOn="{StaticResource BodyTextStyle}">
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="Margin" Value="0,0,0,16"/>
                <Setter Property="HorizontalAlignment" Value="Left"/>
                <Setter Property="TextWrapping" Value="Wrap"/>
            </Style>
        </ResourceDictionary>
    </Page.Resources>

    <Grid x:Name="LayoutRoot">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <Grid HorizontalAlignment="Center" VerticalAlignment="Center" MinWidth="1400">
                <Border x:Name="DetailsPanel" Style="{StaticResource PanelStyle}" Margin="20" Padding="25">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="10">
                            <Image Width="550" Height="550"
                                   Source="{Binding SelectedItem.ImageUri, Mode=OneWay, FallbackValue='ms-appx:///Assets/Images/default-item.jpg'}"
                                   Stretch="Uniform"
                                   Visibility="{Binding SelectedItem.ImageUri, Converter={StaticResource NonEmptyStringToVisibilityConverter}, Mode=OneWay}"/>

                            <StackPanel Orientation="Horizontal" Spacing="15" HorizontalAlignment="Center" Margin="0,10,0,0">
                                <Button Content="Back"
                                        Command="{Binding NavigateBackCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Height="55" MinWidth="130" FontSize="16"/>

                                <Button Content="Share"
                                        Command="{Binding ShareCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Height="55" MinWidth="130" FontSize="16"/>

                                <Button Content="{Binding IsFavorite, Converter={StaticResource BooleanToHeartIconConverter}}"
                                        Command="{Binding AddToFavoritesCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Height="55" MinWidth="130" FontSize="16"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Spacing="15" HorizontalAlignment="Center">
                                <Button Content="Edit"
                                        Command="{Binding EditCommand}"
                                        CommandParameter="{Binding SelectedItem}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Height="55" MinWidth="130" FontSize="16"
                                        Visibility="{Binding IsItemCreator, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                                <Button Content="Delete"
                                        Command="{Binding DeleteCommand}"
                                        CommandParameter="{Binding SelectedItem}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Height="55" MinWidth="130" FontSize="16"
                                        Visibility="{Binding IsItemCreator, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                                <Button Content="My Items"
                                        Command="{Binding NavigateToMyItemsCommand}"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        Height="55" MinWidth="130" FontSize="16"
                                        Visibility="{Binding IsLoggedIn, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            </StackPanel>
                        </StackPanel>

                        <Grid Grid.Column="1" Margin="30,0,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Spacing="20" Margin="0,0,15,0">
                                    <StackPanel>
                                        <TextBlock Text="Name" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Name, Mode=OneWay, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Year" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Year, Mode=OneWay, FallbackValue='0'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Category" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Category, Mode=OneWay, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Condition" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Condition, Mode=OneWay, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Description" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Description, Mode=OneWay, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Spacing="20" Margin="15,0,0,0">
                                    <StackPanel>
                                        <TextBlock Text="Specifications" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Specifications, Mode=OneWay, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Acquisition Date" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.AcquisitionDate, Mode=OneWay, Converter={StaticResource DateTimeToStringConverter}, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Source" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Source, Mode=OneWay, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Notes" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Notes, Mode=OneWay, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Added Date" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.AddedDate, Mode=OneWay, Converter={StaticResource DateTimeToStringConverter}, FallbackValue='N/A'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="Value" Style="{StaticResource ItemHeaderStyle}"/>
                                        <TextBlock Text="{Binding SelectedItem.Value, Mode=OneWay, Converter={StaticResource DecimalConverter}, FallbackValue='$0.00'}" Style="{StaticResource ItemContentStyle}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>

                            <StackPanel Grid.Row="1" Grid.Column="1" HorizontalAlignment="Right" Margin="15,30,0,0"
                                        Visibility="{Binding ShowSellerContact, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <TextBlock Text="Seller Contact" Style="{StaticResource ItemHeaderStyle}"/>
                                <StackPanel Orientation="Vertical" Spacing="8">
                                    <TextBlock Style="{StaticResource ItemContentStyle}"><Run Text="Telegram: " FontWeight="Bold"/><Run Text="{Binding SelectedItem.SellerContact.Telegram, Mode=OneWay, FallbackValue='N/A'}"/></TextBlock>
                                    <TextBlock Style="{StaticResource ItemContentStyle}"><Run Text="Instagram: " FontWeight="Bold"/><Run Text="{Binding SelectedItem.SellerContact.Instagram, Mode=OneWay, FallbackValue='N/A'}"/></TextBlock>
                                    <TextBlock Style="{StaticResource ItemContentStyle}"><Run Text="Phone: " FontWeight="Bold"/><Run Text="{Binding SelectedItem.SellerContact.PhoneNumber, Mode=OneWay, FallbackValue='N/A'}"/></TextBlock>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </Border>

                <TextBlock x:Name="ShareMessage"
                           Text="Link copied to clipboard!"
                           Visibility="Collapsed"
                           Style="{StaticResource ItemContentStyle}"
                           Foreground="Gray"
                           HorizontalAlignment="Center"
                           Margin="0,20,0,0"/>
            </Grid>
        </ScrollViewer>
    </Grid>
</Page>